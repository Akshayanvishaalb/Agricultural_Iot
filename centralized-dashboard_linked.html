<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Smart Plant Monitor Dashboard - Track and manage your plant's health">
  <title>ðŸŒ± Smart Plant Dashboard</title>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <!-- Chart.js for data visualization -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Stylish Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #2f855a;
      --secondary-color: #38a169;
      --accent-color: #3182ce;
      --light-bg: #f7fafc;
      --dark-text: #2d3748;
      --light-text: #718096;
      --danger-color: #e53e3e;
      --warning-color: #dd6b20;
      --success-color: #38a169;
      --border-color: #e2e8f0;
      --card-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      --gradient-start: #d4fc79;
      --gradient-end: #96e6a1;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center; /* Added for vertical centering */
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 800px;
      display: flex;
      flex-direction: column;
      align-items: center; /* Center all content horizontally */
    }

    .header {
      width: 100%;
      max-width: 800px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.95);
      padding: 18px 25px;
      border-radius: 16px;
      box-shadow: var(--card-shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      text-align: center; /* Center text content */
    }

    .header h1 {
      color: var(--primary-color);
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center; /* Center icon and text */
      gap: 12px;
      font-weight: 700;
      margin: 0 auto; /* Center the title in header */
    }

    .user-controls {
      display: flex;
      gap: 18px;
      align-items: center;
      justify-content: center; /* Center controls */
    }

    .user-info {
      text-align: center; /* Center user info text */
      font-size: 14px;
    }

    .user-info span {
      display: block;
      color: var(--light-text);
    }

    .user-name {
      font-weight: 600;
      color: var(--dark-text);
    }

    .logout-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      color: var(--light-text);
      font-size: 14px;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: #f1f5f9;
      color: var(--danger-color);
      transform: translateY(-2px);
    }

    .dashboard-container {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      width: 100%;
      max-width: 800px;
      margin-bottom: 30px;
      justify-content: center; /* Center cards */
    }

    .dashboard-card {
      background: #ffffff;
      padding: 28px;
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      flex: 1;
      min-width: 300px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      text-align: center; /* Center card content */
    }

    .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    .card-header {
      display: flex;
      justify-content: center; /* Center header content */
      align-items: center;
      margin-bottom: 20px;
      gap: 15px;
    }

    .card-header h2 {
      font-size: 20px;
      color: var(--dark-text);
      font-weight: 700;
    }

    .card-icon {
      font-size: 22px;
      color: var(--primary-color);
      background: #e6fffa;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      box-shadow: 0 5px 15px rgba(56, 161, 105, 0.2);
    }

    .reading {
      display: flex;
      align-items: center;
      justify-content: center; /* Center readings */
      margin: 22px 0;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(226, 232, 240, 0.5);
    }

    .reading:last-of-type {
      border-bottom: none;
    }

    .reading-icon {
      margin-right: 20px;
      font-size: 22px;
      width: 40px;
      height: 40px;
      background: var(--light-bg);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .reading-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--accent-color);
    }

    .reading-unit {
      font-size: 16px;
      color: var(--light-text);
      margin-left: 5px;
    }

    .reading-label {
      font-size: 14px;
      color: var(--light-text);
      margin-top: 4px;
      font-weight: 500;
      text-align: center; /* Center labels */
    }

    .plant-status {
      padding: 12px 18px;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 500;
      margin: 20px auto; /* Center status alerts */
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      max-width: 90%;
    }

    .status-optimal {
      background-color: #d1fae5;
      color: var(--success-color);
    }

    .status-warning {
      background-color: #fef3c7;
      color: var(--warning-color);
    }

    .status-alert {
      background-color: #fee2e2;
      color: var(--danger-color);
    }

    .chart-container {
      height: 220px;
      margin: 20px auto; /* Center charts */
      width: 100%;
    }

    .controls {
      margin-top: 25px;
      display: flex;
      gap: 12px;
      justify-content: center; /* Center buttons */
      flex-wrap: wrap;
    }

    .control-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 18px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(47, 133, 90, 0.2);
    }

    .control-btn:hover {
      background: var(--secondary-color);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(47, 133, 90, 0.3);
    }

    .control-btn.secondary {
      background: white;
      color: var(--primary-color);
      border: 1px solid var(--primary-color);
      box-shadow: none;
    }

    .control-btn.secondary:hover {
      background: #f0fff4;
      transform: translateY(-3px);
      box-shadow: 0 4px 10px rgba(47, 133, 90, 0.1);
    }

    .history-card {
      width: 100%;
    }

    .settings-form {
      display: grid;
      gap: 18px;
      margin-top: 20px;
      width: 100%;
      max-width: 400px; /* Limit form width for better readability */
      margin-left: auto;
      margin-right: auto; /* Center form */
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center; /* Center form elements */
    }

    .form-group label {
      font-size: 15px;
      color: var(--dark-text);
      font-weight: 500;
      text-align: center; /* Center labels */
    }

    .form-input {
      padding: 10px 15px;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 15px;
      transition: border 0.3s ease, box-shadow 0.3s ease;
      width: 100%; /* Full width inputs */
      text-align: center; /* Center input text */
    }

    .form-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
    }

    .device-selection {
      margin: 20px auto 15px; /* Center device selection */
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      width: 100%;
      flex-wrap: wrap;
    }

    .device-dropdown {
      padding: 10px 15px;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      font-size: 15px;
      width: 220px;
      background-color: white;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      text-align: center; /* Center dropdown text */
    }

    .last-updated {
      font-size: 13px;
      color: var(--light-text);
      margin-top: 15px;
      text-align: center; /* Center timestamp */
      font-style: italic;
      width: 100%;
    }

    .tab-container {
      display: flex;
      gap: 12px;
      margin-bottom: 25px;
      width: 100%;
      max-width: 800px;
      justify-content: center; /* Center tabs */
    }

    .tab-btn {
      padding: 12px 24px;
      background: rgba(255, 255, 255, 0.8);
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
      color: var(--light-text);
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    .tab-btn.active {
      background: white;
      color: var(--primary-color);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      transform: translateY(-3px);
    }

    .tab-btn:hover:not(.active) {
      transform: translateY(-2px);
    }

    .tab-content {
      display: none;
      width: 100%;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.4s ease;
    }
    /* Weather tab styles */
    .search-box {
      display: flex;
      margin: 20px 0;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
      flex-direction: column;
    }

    #location {
      flex-grow: 1;
      min-width: 200px;
    }

    .error-message {
      color: var(--danger-color);
      text-align: center;
      margin-top: 10px;
      display: none;
      background-color: rgba(229, 62, 62, 0.1);
      padding: 10px;
      border-radius: 10px;
    }

    .weather-info {
      text-align: center;
      display: none;
    }

    .location-info {
      margin-bottom: 15px;
      font-size: 16px;
      color: var(--light-text);
    }

    #location-name {
      font-size: 18px;
      font-weight: 600;
      color: var(--dark-text);
      margin-bottom: 5px;
    }

    .current-weather {
      display: flex;
      align-items: center;
      justify-content: space-around;
      margin-bottom: 20px;
      padding: 15px;
      background-color: rgba(255, 255, 255, 0.7);
      border-radius: 12px;
    }

    .current-temp {
      font-size: 42px;
      font-weight: bold;
      color: var(--dark-text);
    }

    .weather-icon img {
      width: 80px;
      height: 80px;
    }

    .condition-text {
      font-size: 18px;
      color: var(--light-text);
      margin-top: 5px;
    }

    .details {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .detail-item {
      background-color: var(--light-bg);
      border-radius: 10px;
      padding: 12px;
      text-align: left;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .detail-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
    }

    .detail-label {
      font-size: 14px;
      color: var(--light-text);
      margin-bottom: 5px;
    }

    .detail-value {
      font-size: 18px;
      font-weight: 600;
      color: var(--dark-text);
    }

    .forecast {
      margin-top: 25px;
      border-top: 1px solid var(--border-color);
      padding-top: 20px;
    }

    .forecast-container {
      display: flex;
      overflow-x: auto;
      gap: 15px;
      padding-bottom: 15px;
      justify-content: center;
    }

    .forecast-day {
      min-width: 120px;
      max-width: 150px;
      background-color: var(--light-bg);
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .forecast-day:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    }

    .forecast-date {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--dark-text);
    }

    .forecast-icon img {
      width: 50px;
      height: 50px;
      margin: 5px 0;
    }

    .forecast-temp {
      display: flex;
      justify-content: space-around;
      font-size: 14px;
      margin-top: 10px;
    }

    .max-temp {
      color: var(--danger-color);
      font-weight: 600;
    }

    .min-temp {
      color: var(--accent-color);
      font-weight: 600;
    }

    .location-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 5px;
      display: none;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Make sure the detail items stack nicely on smaller screens */
    @media (max-width: 600px) {
      .details {
        grid-template-columns: 1fr;
      }
      
      #search-btn, #locate-btn {
        width: 100%;
      }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    footer {
      margin-top: 30px;
      font-size: 14px;
      color: var(--light-text);
      text-align: center;
      width: 100%;
      padding: 15px 0;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal.visible {
      opacity: 1;
    }

    .modal-content {
      background: white;
      padding: 35px;
      border-radius: 16px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      transform: scale(0.9);
      transition: transform 0.3s ease;
      text-align: center; /* Center modal content */
    }

    .modal.visible .modal-content {
      transform: scale(1);
    }

    .modal-header {
      display: flex;
      justify-content: center; /* Center modal header */
      align-items: center;
      margin-bottom: 25px;
      position: relative;
    }

    .modal-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--dark-text);
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--light-text);
      transition: color 0.3s ease;
      position: absolute;
      right: 0;
    }

    .close-modal:hover {
      color: var(--danger-color);
    }

    .plant-selection {
      margin-top: 20px;
      text-align: center; /* Center plant selection */
    }

    .plants-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 15px;
      margin: 20px auto; /* Center plant grid */
      max-width: 400px;
    }

    .plant-card {
      background: var(--light-bg);
      border-radius: 12px;
      padding: 18px 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .plant-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .plant-card.selected {
      border: 2px solid var(--primary-color);
      background-color: rgba(47, 133, 90, 0.1);
    }

    .plant-icon {
      font-size: 36px;
      margin-bottom: 12px;
    }

    .plant-name {
      font-size: 15px;
      font-weight: 500;
    }

    #loadingIndicator {
      display: none;
      text-align: center;
      padding: 30px;
      color: var(--light-text);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      box-shadow: var(--card-shadow);
      max-width: 800px;
      width: 100%;
    }

    .spinner {
      border: 5px solid rgba(0, 0, 0, 0.1);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border-left-color: var(--primary-color);
      animation: spin 1.2s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    /* Searchable dropdown styles */
  .dropdown-container {
    position: relative;
    width: 220px;
  }

  .dropdown-button {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 10px 15px;
    background-color: white;
    border: 1px solid var(--border-color);
    border-radius: 10px;
    cursor: pointer;
    font-size: 15px;
    text-align: left;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  }

  .dropdown-button:hover {
    border-color: var(--accent-color);
  }

  .dropdown-button:focus {
    outline: none;
    border-color: var(--accent-color);
    box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.2);
  }

  .dropdown-icon {
    border: solid #666;
    border-width: 0 2px 2px 0;
    display: inline-block;
    padding: 3px;
    transform: rotate(45deg);
    transition: transform 0.2s;
  }

  .dropdown-content {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    margin-top: 5px;
    max-height: 250px;
    overflow-y: auto;
    background-color: white;
    border: 1px solid var(--border-color);
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: 100;
    display: none;
  }

  .dropdown-content.show {
    display: block;
    animation: fadeIn 0.2s ease;
  }

  .search-box {
    width: 100%;
    padding: 10px 12px;
    border: none;
    border-bottom: 1px solid #eee;
    font-size: 14px;
  }

  .search-box:focus {
    outline: none;
    border-bottom-color: var(--accent-color);
  }

  .dropdown-items {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .dropdown-item {
    padding: 10px 16px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  .dropdown-item:hover {
    background-color: #f5f5f5;
  }

  .dropdown-item.selected {
    background-color: #e6f0ff;
    font-weight: 600;
    color: var(--primary-color);
  }

  .no-results {
    padding: 10px 16px;
    color: var(--light-text);
    font-style: italic;
    text-align: center;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .dropdown-container {
      width: 90%;
    }
  }
    /* Custom slider styling */
    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: #e2e8f0;
      outline: none;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--primary-color);
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      transition: all 0.2s ease;
    }
    
    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.2);
    }

    /* Improved checkbox styling */
    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--primary-color);
      margin-right: 8px;
    }

    /* Care info styling */
    #careInfo ul {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #careInfo li {
      display: flex;
      justify-content: center;
      width: fit-content;
    }

    /* Responsive styles */
    @media (max-width: 768px) {
      .dashboard-container {
        flex-direction: column;
        align-items: center;
      }
      
      .dashboard-card {
        width: 100%;
      }
      
      .header {
        flex-direction: column;
        text-align: center;
        gap: 15px;
        padding: 20px 15px;
      }
      
      .user-controls {
        width: 100%;
        justify-content: center;
      }
      
      .tab-container {
        overflow-x: auto;
        padding-bottom: 5px;
        justify-content: center;
      }
      
      .tab-btn {
        white-space: nowrap;
        padding: 10px 18px;
      }
      
      .device-selection {
        flex-direction: column;
        align-items: center;
      }
      
      .device-dropdown {
        width: 90%;
      }
      .notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 10px;
        color: white;
        font-weight: 500;
        max-width: 300px;
        z-index: 1000;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.3s, transform 0.3s;
        display: flex;
        align-items: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      }

      .notification.success {
        background-color: var(--success-color);
      }

      .notification.error {
        background-color: var(--danger-color);
      }

      .notification.warning {
        background-color: var(--warning-color);
      }

      .notification.show {
        opacity: 1;
        transform: translateY(0);
      }

      .notification-icon {
        margin-right: 10px;
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
<script>
    function weather_page() {
      location.href = "weather_app_linked.html"
    }
    const firebaseConfig = {
      apiKey: "AIzaSyBv-b3ftdw08O9tf0gSFWeAyEBB0EJvQLo",
      authDomain: "iot-project-9d263.firebaseapp.com",
      databaseURL: "https://iot-project-9d263-default-rtdb.firebaseio.com",
      projectId: "iot-project-9d263",
      storageBucket: "iot-project-9d263.firebasestorage.app",
      messagingSenderId: "600169469414",
      appId: "1:600169469414:web:c796397351100a70ce7227",
      measurementId: "G-BB0P86VPPL"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const userEmail = localStorage.getItem("user_email"); // Get email from localStorage
    if (!userEmail) {
      window.location.href = "index.html";
    }
    const deviceId = "esp32_device_1"; // Device ID (can be dynamically set)
    function Logout(){
      localStorage.removeItem("user_email")
      window.location.href = "index.html";
    }
  </script>
  <div class="container">
    <div class="header">
      <h1><i class="fas fa-leaf"></i> Smart Plant Monitor</h1>
      <div class="user-controls">
        <div class="user-info">
          <span class="user-name" id="userName">Loading...</span>
          <script type="text/javascript">
            document.getElementById("userName").textContent = userEmail;
          </script>
        </div>
        <button id="logoutBtn" class="logout-btn" onclick="Logout()">Logout</button>
      </div>
    </div>

    <div class="tab-container">
      <button class="tab-btn active" data-tab="dashboard">Dashboard</button>
      <button class="tab-btn" data-tab="history" onclick=location.href="Analysis.html">Analysis</button>
      <button class="tab-btn" data-tab="weather" onclick="weather_page()">Weather</a></button>
    </div>

    <div id="loadingIndicator">
      <div class="spinner"></div>
      <p>Loading plant data...</p>
    </div>

    <!-- Dashboard Tab -->
    <div id="dashboard" class="tab-content active">
    <div class="device-selection">
      <div class="dropdown-container">
        <button type="button" class="dropdown-button" id="dropdown">
          <span id="dropdown-text">Select a Plant...</span>
          <span class="dropdown-icon"></span>
        </button>
        <div class="dropdown-content" id="dropdown-content">
          <input type="text" class="search-box" id="search-box" placeholder="Search plants...">
          <ul class="dropdown-items" id="dropdown-items">
            <!-- Plant options will be added dynamically here -->
          </ul>
          <div class="no-results" id="no-results" style="display: none;">No matching plants found</div>
        </div>
      </div>
      <button id="addDeviceBtn" class="control-btn secondary">
        <i class="fas fa-plus"></i> Add Plant
      </button>
      <button id="showDetailsBtn" class="control-btn secondary">
        <i class="fas fa-info-circle"></i> Show Details
      </button>

<!-- Add this notification system if it doesn't exist -->
<div id="notification-container" style="position: fixed; top: 20px; right: 20px; z-index: 1000;"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Notification system implementation
  function showNotification(message, type = 'info', autoHide = true) {
    const container = document.getElementById('notification-container');
    if (!container) {
      console.error("Notification container not found");
      return;
    }
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.style.padding = '10px 15px';
    notification.style.marginBottom = '10px';
    notification.style.borderRadius = '4px';
    notification.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
    
    // Set background color based on type
    switch(type) {
      case 'success':
        notification.style.backgroundColor = '#4CAF50';
        notification.style.color = 'white';
        break;
      case 'error':
        notification.style.backgroundColor = '#F44336';
        notification.style.color = 'white';
        break;
      case 'warning':
        notification.style.backgroundColor = '#FF9800';
        notification.style.color = 'white';
        break;
      default:
        notification.style.backgroundColor = '#2196F3';
        notification.style.color = 'white';
    }
    
    notification.textContent = message;
    container.appendChild(notification);
    
    if (autoHide) {
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transition = 'opacity 0.5s';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 500);
      }, 3000);
    }
    
    return notification;
  }
  
  function hideNotification() {
    const container = document.getElementById('notification-container');
    if (container) {
      container.innerHTML = '';
    }
  }

  // Add event listener for the Show Details button
  const showDetailsBtn = document.getElementById('showDetailsBtn');
  if (showDetailsBtn) {
    showDetailsBtn.addEventListener('click', function() {
      // Get the selected plant from the dropdown
      const dropdownElement = document.getElementById('dropdown-text');
      
      // Check if dropdown element exists
      if (!dropdownElement) {
        console.error("Dropdown element not found");
        showNotification('Dropdown element not found', 'error');
        return;
      }
      
      const selectedPlantText = dropdownElement.textContent;
      
      // Check if a plant is actually selected
      if (selectedPlantText === 'Select a Plant...' || !selectedPlantText) {
        showNotification('Please select a plant first', 'warning');
        return;
      }
      
      // Encode the plant name for Firebase path (replace spaces with underscores)
      const encodedPlant = selectedPlantText.replace(/\s/g, "_");
      
      // Get user email from localStorage
      const userEmail = localStorage.getItem("user_email");
      if (!userEmail) {
        showNotification('You must be logged in to view plant details', 'error');
        return;
      }
      
      // Show loading notification
      showNotification('Loading plant data...', 'info', false);
      
      // Create reference to the specific plant data
      const plantDataRef = firebase.database().ref(`sensor_data/${userEmail}/${encodedPlant}`);
      
      // Fetch the plant data
      plantDataRef.once('value')
        .then((snapshot) => {
          // Hide loading notification
          hideNotification();
          
          const plantData = snapshot.val();
          if (plantData) {
            // Update UI with the plant data
            updatePlantReadings(plantData, selectedPlantText);
            showNotification(`Loaded data for ${selectedPlantText}`, 'success');
          } else {
            showNotification(`No sensor data available for ${selectedPlantText}`, 'warning');
          }
        })
        .catch((error) => {
          hideNotification();
          console.error("Error fetching plant data:", error);
          showNotification(`Failed to load data: ${error.message}`, 'error');
        });
    });
  } else {
    console.error("Show Details button not found in the DOM");
  }

  // Function to update plant readings in the UI
  function updatePlantReadings(plantData, plantName) {
    // Find the latest entry
    let latestEntry = null;
    let latestTimestamp = 0;
    
    // Check if plantData has timestamp-keyed entries
    if (typeof plantData === 'object' && plantData !== null) {
      Object.keys(plantData).forEach(key => {
        const entry = plantData[key];
        if (entry && entry.timestamp && entry.timestamp > latestTimestamp) {
          latestEntry = entry;
          latestTimestamp = entry.timestamp;
        }
      });
    }
    
    if (latestEntry) {
      // Safely update UI elements, checking if they exist first
      updateElementIfExists("moisture", latestEntry.soil_moisture);
      updateElementIfExists("pH", latestEntry.soil_ph);
      updateElementIfExists("light", latestEntry.ldr);
      updateElementIfExists("airTemp", latestEntry.temperature);
      updateElementIfExists("humidity", latestEntry.humidity);
      updateElementIfExists("deviceName", plantName);
      
      // Update last updated timestamp
      if (document.getElementById("lastUpdated")) {
        const date = new Date(latestTimestamp);
        document.getElementById("lastUpdated").textContent = date.toLocaleString();
      }
    } else {
      console.warn("No valid entries found in plant data");
      showNotification("No sensor readings found for this plant", "warning");
    }
  }
  
  // Helper function to safely update DOM elements
  function updateElementIfExists(elementId, value) {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = value !== undefined ? value : "N/A";
    } else {
      console.warn(`Element with ID '${elementId}' not found in the DOM`);
    }
  }
});
</script>
<!-- Add this notification system if it doesn't exist -->
<div id="notification-container" style="position: fixed; top: 20px; right: 20px; z-index: 1000;"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Notification system implementation
  function showNotification(message, type = 'info', autoHide = true) {
    const container = document.getElementById('notification-container');
    if (!container) {
      console.error("Notification container not found");
      return;
    }
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.style.padding = '10px 15px';
    notification.style.marginBottom = '10px';
    notification.style.borderRadius = '4px';
    notification.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
    
    // Set background color based on type
    switch(type) {
      case 'success':
        notification.style.backgroundColor = '#4CAF50';
        notification.style.color = 'white';
        break;
      case 'error':
        notification.style.backgroundColor = '#F44336';
        notification.style.color = 'white';
        break;
      case 'warning':
        notification.style.backgroundColor = '#FF9800';
        notification.style.color = 'white';
        break;
      default:
        notification.style.backgroundColor = '#2196F3';
        notification.style.color = 'white';
    }
    
    notification.textContent = message;
    container.appendChild(notification);
    
    if (autoHide) {
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transition = 'opacity 0.5s';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 500);
      }, 3000);
    }
    
    return notification;
  }
  
  function hideNotification() {
    const container = document.getElementById('notification-container');
    if (container) {
      container.innerHTML = '';
    }
  }

  // Add event listener for the Show Details button
  const showDetailsBtn = document.getElementById('showDetailsBtn');
  if (showDetailsBtn) {
    showDetailsBtn.addEventListener('click', function() {
      // Get the selected plant from the dropdown
      const dropdownElement = document.getElementById('dropdown-text');
      
      // Check if dropdown element exists
      if (!dropdownElement) {
        console.error("Dropdown element not found");
        showNotification('Dropdown element not found', 'error');
        return;
      }
      
      const selectedPlantText = dropdownElement.textContent;
      
      // Check if a plant is actually selected
      if (selectedPlantText === 'Select a Plant...' || !selectedPlantText) {
        showNotification('Please select a plant first', 'warning');
        return;
      }
      
      // Encode the plant name for Firebase path (replace spaces with underscores)
      const encodedPlant = selectedPlantText.replace(/\s/g, "_");
      
      // Get user email from localStorage
      const userEmail = localStorage.getItem("user_email");
      if (!userEmail) {
        showNotification('You must be logged in to view plant details', 'error');
        return;
      }
      
      // Show loading notification
      showNotification('Loading plant data...', 'info', false);
      
      // Create reference to the specific plant data
      const plantDataRef = firebase.database().ref(`sensor_data/${userEmail}/${encodedPlant}`);
      
      // Fetch the plant data
      plantDataRef.once('value')
        .then((snapshot) => {
          // Hide loading notification
          hideNotification();
          
          const plantData = snapshot.val();
          if (plantData) {
            // Update UI with the plant data
            updatePlantReadings(plantData, selectedPlantText);
            showNotification(`Loaded data for ${selectedPlantText}`, 'success');
          } else {
            showNotification(`No sensor data available for ${selectedPlantText}`, 'warning');
          }
        })
        .catch((error) => {
          hideNotification();
          console.error("Error fetching plant data:", error);
          showNotification(`Failed to load data: ${error.message}`, 'error');
        });
    });
  } else {
    console.error("Show Details button not found in the DOM");
  }

  // Function to update plant readings in the UI
  function updatePlantReadings(plantData, plantName) {
    // Find the latest entry
    let latestEntry = null;
    let latestTimestamp = 0;
    
    // Check if plantData has timestamp-keyed entries
    if (typeof plantData === 'object' && plantData !== null) {
      Object.keys(plantData).forEach(key => {
        const entry = plantData[key];
        if (entry && entry.timestamp && entry.timestamp > latestTimestamp) {
          latestEntry = entry;
          latestTimestamp = entry.timestamp;
        }
      });
    }
    
    if (latestEntry) {
      // Safely update UI elements, checking if they exist first
      updateElementIfExists("moisture", latestEntry.soil_moisture);
      updateElementIfExists("pH", latestEntry.soil_ph);
      updateElementIfExists("light", latestEntry.ldr);
      updateElementIfExists("airTemp", latestEntry.temperature);
      updateElementIfExists("humidity", latestEntry.humidity);
      updateElementIfExists("deviceName", plantName);
      
      // Update last updated timestamp
      if (document.getElementById("lastUpdated")) {
        const date = new Date(latestTimestamp);
        document.getElementById("lastUpdated").textContent = date.toLocaleString();
      }
    } else {
      console.warn("No valid entries found in plant data");
      showNotification("No sensor readings found for this plant", "warning");
    }
  }
  
  // Helper function to safely update DOM elements
  function updateElementIfExists(elementId, value) {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = value !== undefined ? value : "N/A";
    } else {
      console.warn(`Element with ID '${elementId}' not found in the DOM`);
    }
  }
});
</script>
    </div>
    <script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
  // Get the plant dropdown elements
  const dropdown = document.getElementById('dropdown');
  const dropdownContent = document.getElementById('dropdown-content');
  const dropdownText = document.getElementById('dropdown-text');
  const searchBox = document.getElementById('search-box');
  const dropdownItems = document.getElementById('dropdown-items');
  const noResults = document.getElementById('no-results');
  const careInfoSection = document.getElementById('careInfo');
  
  // Initialize Firebase - add your config here
  // Your Firebase configuration is already initialized in your HTML or another JS file
  // Access the existing Firebase instance
  const database = firebase.database();
  const plantDataRef = database.ref('plant_data');
  let plants = [];
  
  // Fetch plants from Firebase
  function fetchPlants() {
    console.log("Attempting to fetch plants from Firebase...");
    try {
      plantDataRef.on('value', (snapshot) => {
        console.log("Firebase data received:", snapshot.val());
        plants = [];
        snapshot.forEach((childSnapshot) => {
          const plantName = childSnapshot.key;
          plants.push({
            id: plantName,
            name: plantName
          });
        });
        console.log("Plants extracted:", plants);
        // Populate dropdown after fetching data
        populateDropdown();
      }, (error) => {
        console.error("Firebase data fetch error:", error);
        if (document.getElementById('errorMessage')) {
          document.getElementById('errorMessage').textContent = 
            "Failed to load plant data: " + error.message;
          document.getElementById('errorMessage').style.display = 'block';
        }
      });
    } catch (error) {
      console.error("Exception while setting up Firebase listener:", error);
    }
  }
  
  // Populate dropdown with plant options
  function populateDropdown() {
    dropdownItems.innerHTML = '';
    plants.forEach(plant => {
      const li = document.createElement('li');
      li.className = 'dropdown-item';
      li.textContent = plant.name;
      li.dataset.value = plant.id;
      dropdownItems.appendChild(li);
    });
    
    // Add click event for each plant option
    const items = dropdownItems.getElementsByClassName('dropdown-item');
    for (let item of items) {
      item.addEventListener('click', function() {
        // Update selected plant
        dropdownText.textContent = this.textContent;
        const plantId = this.dataset.value;
        
        // Load the selected plant's data from Firebase
        loadPlantData(plantId);
        
        // Close dropdown and reset search
        dropdownContent.classList.remove('show');
        dropdown.querySelector('.dropdown-icon').style.transform = 'rotate(45deg)';
        searchBox.value = '';
        resetDropdownItems();
    
// Add event listener for the Add Plant button
document.getElementById('addDeviceBtn').addEventListener('click', function() {
  // Get the selected plant from the dropdown
  const selectedPlantText = document.getElementById('dropdown-text').textContent;
  
  // Check if a plant is actually selected
  if (selectedPlantText === 'Select a Plant...') {
    showNotification('Please select a plant before adding', 'warning');
    return;
  }
  
  // Get the plant ID from the dropdown
  const selectedPlantId = selectedPlantText;
  
  // Reference to the user's plants in Firebase
  const userEmail = localStorage.getItem("user_email");
  if (!userEmail) {
    showNotification('You must be logged in to add plants', 'error');
    return;
  }
  
  // Reference to user's plants in the database
  const userPlantsRef = firebase.database().ref(`sensor_data/${userEmail}`);
  
  // Check if this plant is already added
  userPlantsRef.once('value', (snapshot) => {
    const existingPlants = snapshot.val() || {};
    
    // Check if plant already exists for this user
    if (existingPlants[selectedPlantId]) {
      showNotification(`You already have a ${selectedPlantId} in your dashboard`, 'warning');
      return;
    }

    // Show loading notification
    showNotification('Adding plant to your dashboard...', 'info', false);
    const Encoded_Plant = selectedPlantId.replace(/\s/g, "_");
    // Add the plant to the user's plants
    userPlantsRef.child(Encoded_Plant).set({
      added_date: new Date().toISOString(),
      plant_id: Encoded_Plant,
    }).then(() => {
      // Hide the loading notification
      hideNotification();
      // Show success notification
      showNotification(`${selectedPlantId} has been added to your dashboard`, 'success');
      
      // Optionally refresh the page or update the UI after a short delay
      setTimeout(() => {
        location.reload(); // Or implement a more elegant UI update
      }, 2000);
    }).catch(error => {
      console.error("Error adding plant:", error);
      showNotification(`Failed to add ${selectedPlantId}: ${error.message}`, 'error');
    });
  });
});

// Add these notification helper functions
function showNotification(message, type = 'info', autoHide = true) {
  // Remove any existing notification
  hideNotification();
  
  // Create notification element
  const notification = document.createElement('div');
  notification.id = 'notification';
  notification.className = `notification notification-${type}`;
  
  // Add icon based on notification type
  let icon = '';
  switch(type) {
    case 'success':
      icon = '<i class="fas fa-check-circle"></i>';
      break;
    case 'error':
      icon = '<i class="fas fa-exclamation-circle"></i>';
      break;
    case 'warning':
      icon = '<i class="fas fa-exclamation-triangle"></i>';
      break;
    default:
      icon = '<i class="fas fa-info-circle"></i>';
  }
  
  // Add content to notification
  notification.innerHTML = `
    <div class="notification-content">
      ${icon}
      <span>${message}</span>
    </div>
    <button class="notification-close"><i class="fas fa-times"></i></button>
  `;
  
  // Add styles to the notification element
  notification.style.position = 'fixed';
  notification.style.top = '20px';
  notification.style.right = '20px';
  notification.style.zIndex = '9999';
  notification.style.backgroundColor = type === 'success' ? '#d1fae5' : 
                                      type === 'error' ? '#fee2e2' : 
                                      type === 'warning' ? '#fef3c7' : '#e0f2fe';
  notification.style.color = type === 'success' ? '#047857' : 
                            type === 'error' ? '#b91c1c' : 
                            type === 'warning' ? '#b45309' : '#0369a1';
  notification.style.padding = '16px 20px';
  notification.style.borderRadius = '10px';
  notification.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.15)';
  notification.style.display = 'flex';
  notification.style.alignItems = 'center';
  notification.style.justifyContent = 'space-between';
  notification.style.maxWidth = '400px';
  notification.style.minWidth = '300px';
  notification.style.animation = 'slideIn 0.3s ease';
  
  // Add style for notification content
  const content = notification.querySelector('.notification-content');
  content.style.display = 'flex';
  content.style.alignItems = 'center';
  content.style.gap = '12px';
  
  // Add style for notification close button
  const closeBtn = notification.querySelector('.notification-close');
  closeBtn.style.background = 'none';
  closeBtn.style.border = 'none';
  closeBtn.style.color = 'inherit';
  closeBtn.style.cursor = 'pointer';
  closeBtn.style.fontSize = '16px';
  closeBtn.style.opacity = '0.7';
  closeBtn.style.transition = 'opacity 0.2s';
  
  // Add hover effect to close button
  closeBtn.onmouseover = function() {
    this.style.opacity = '1';
  };
  closeBtn.onmouseout = function() {
    this.style.opacity = '0.7';
  };
  
  // Add click event to close button
  closeBtn.onclick = hideNotification;
  
  // Add the notification to the DOM
  document.body.appendChild(notification);
  
  // Add animation keyframes
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
  `;
  document.head.appendChild(style);
  
  // Auto hide after 5 seconds if autoHide is true
  if (autoHide) {
    setTimeout(hideNotification, 5000);
  }
}

function hideNotification() {
  const notification = document.getElementById('notification');
  if (notification) {
    // Add slide out animation
    notification.style.animation = 'slideOut 0.3s ease forwards';
    
    // Remove notification after animation completes
    setTimeout(() => {
      if (notification.parentNode) {
        notification.parentNode.removeChild(notification);
      }
    }, 300);
  }
}
      });
    }
  }
  
  // Toggle dropdown
  dropdown.addEventListener('click', function() {
    dropdownContent.classList.toggle('show');
    if (dropdownContent.classList.contains('show')) {
      searchBox.focus();
      dropdown.querySelector('.dropdown-icon').style.transform = 'rotate(-135deg)';
    } else {
      dropdown.querySelector('.dropdown-icon').style.transform = 'rotate(45deg)';
    }
  });
  
  // Close dropdown when clicking outside
  window.addEventListener('click', function(event) {
    if (!event.target.closest('.dropdown-container')) {
      dropdownContent.classList.remove('show');
      dropdown.querySelector('.dropdown-icon').style.transform = 'rotate(45deg)';
      searchBox.value = '';
      resetDropdownItems();
    }
  });
  
  // Search functionality
  searchBox.addEventListener('input', function() {
    const searchValue = this.value.toLowerCase();
    const items = dropdownItems.getElementsByClassName('dropdown-item');
    let hasVisibleItems = false;
    
    for (let item of items) {
      const text = item.textContent.toLowerCase();
      if (text.includes(searchValue)) {
        item.style.display = '';
        hasVisibleItems = true;
      } else {
        item.style.display = 'none';
      }
    }
    
    // Show/hide no results message
    noResults.style.display = hasVisibleItems ? 'none' : 'block';
  });
  
  // Reset dropdown items visibility
  function resetDropdownItems() {
    const items = dropdownItems.getElementsByClassName('dropdown-item');
    for (let item of items) {
      item.style.display = '';
    }
    noResults.style.display = 'none';
  }
  
  // Function to load plant data from Firebase
  function loadPlantData(plantId) {
    console.log("Loading data for plant:", plantId);
    // Reference to the specific plant in the database
    const specificPlantRef = plantDataRef.child(plantId);
    
    try {
      specificPlantRef.on('value', (snapshot) => {
        const plantData = snapshot.val();
        console.log("Plant data received:", plantData);
        
        if (plantData) {
          updatePlantInfo(plantId, plantData);
        } else {
          console.error("Plant data not found or is null");
          if (careInfoSection) {
            careInfoSection.style.display = 'none';
          }
          
          // Show an error message
          if (document.getElementById('plantDataError')) {
            document.getElementById('plantDataError').style.display = 'block';
          } else {
            const errorDiv = document.createElement('div');
            errorDiv.id = 'plantDataError';
            errorDiv.textContent = "No data available for this plant";
            errorDiv.style.color = 'red';
            document.getElementById('plantName').after(errorDiv);
          }
        }
      }, (error) => {
        console.error("Error fetching plant data:", error);
        if (careInfoSection) {
          careInfoSection.style.display = 'none';
        }
      });
    } catch (error) {
      console.error("Exception while setting up plant data listener:", error);
    }
  }
  
  // Update plant information in the UI
  function updatePlantInfo(plantName, data) {
    // Update plant name
    document.getElementById('plantName').textContent = plantName;
    
    // Display care information section
    careInfoSection.style.display = 'block';
    
    // Update care information based on data from Firebase
    // Map these to your HTML elements where you want to display this info
    const careInfoHTML = `
      <div class="care-parameter">
        <span class="label">Humidity Range:</span> 
        <span class="value">${data.min_humidity}% - ${data.max_humidity}%</span>
      </div>
      <div class="care-parameter">
        <span class="label">Light Level:</span> 
        <span class="value">${data.min_light} - ${data.max_light}</span>
      </div>
      <div class="care-parameter">
        <span class="label">Moisture Range:</span> 
        <span class="value">${data.min_moisture}% - ${data.max_moisture}%</span>
      </div>
      <div class="care-parameter">
        <span class="label">pH Range:</span> 
        <span class="value">${data.min_ph} - ${data.max_ph}</span>
      </div>
      <div class="care-parameter">
        <span class="label">Temperature Range:</span> 
        <span class="value">${data.min_temp}Â°C - ${data.max_temp}Â°C</span>
      </div>
    `;
    
    // Insert the care information into the care info section
    const careDetailsContainer = document.getElementById('careDetails');
    if (careDetailsContainer) {
      careDetailsContainer.innerHTML = careInfoHTML;
    } else {
      // If the container doesn't exist yet, create it
      const detailsDiv = document.createElement('div');
      detailsDiv.id = 'careDetails';
      detailsDiv.innerHTML = careInfoHTML;
      careInfoSection.appendChild(detailsDiv);
    }
  }
  
  // Initialize by fetching plants from Firebase
  try {
    fetchPlants();
  } catch (error) {
    console.error("Error during initialization:", error);
    // Display a user-friendly error message on the page
    if (document.getElementById('errorMessage')) {
      document.getElementById('errorMessage').textContent = 
        "Unable to load plant data. Please check your connection and refresh the page.";
      document.getElementById('errorMessage').style.display = 'block';
    }
  }
});
    </script>
      <div class="dashboard-container">
        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-water"></i>
            </div>
            <h2>Soil Conditions</h2>
          </div>
          
          <div class="reading">
            <div class="reading-icon">
              <i class="fas fa-tint" style="color: #3182ce;"></i>
            </div>
            <div>
              <div>
                <span id="moisture" class="reading-value">--</span>
                <span class="reading-unit">%</span>
              </div>
              <div class="reading-label">Soil Moisture</div>
            </div>
          </div>

          <div class="reading">
            <div class="reading-icon">
              <i class="fas fa-flask" style="color: #805ad5;"></i>
            </div>
            <div>
              <div>
                <span id="pH" class="reading-value">--</span>
                <span class="reading-unit">pH</span>
              </div>
              <div class="reading-label">Soil pH Level</div>
            </div>
          </div>
        </div>

        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-cloud-sun"></i>
            </div>
            <h2>Environment</h2>
          </div>
          
          <div class="reading">
            <div class="reading-icon">
              <i class="fas fa-sun" style="color: #ecc94b;"></i>
            </div>
            <div>
              <div>
                <span id="light" class="reading-value">--</span>
                <span class="reading-unit">lux</span>
              </div>
              <div class="reading-label">Light Intensity</div>
            </div>
          </div>

          <div class="reading">
            <div class="reading-icon">
              <i class="fas fa-temperature-high" style="color: #e53e3e;"></i>
            </div>
            <div>
              <div>
                <span id="airTemp" class="reading-value">--</span>
                <span class="reading-unit">Â°C</span>
              </div>
              <div class="reading-label">Air Temperature</div>
            </div>
          </div>

          <div class="reading">
            <div class="reading-icon">
              <i class="fas fa-tint" style="color: #63b3ed;"></i>
            </div>
            <div>
              <div>
                <span id="humidity" class="reading-value">--</span>
                <span class="reading-unit">%</span>
              </div>
              <div class="reading-label">Air Humidity</div>
            </div>
          </div>

          <div id="weather" class="tab-content">
            <div class="dashboard-container">
              <div class="dashboard-card">
                <div class="card-header">
                  <div class="card-icon">
                    <i class="fas fa-cloud-sun"></i>
                  </div>
                  <h2>Local Weather</h2>
                </div>

          

                <div class="search-box">
        <input type="text" id="location" placeholder="Enter city name, zip code, or coordinates" autocomplete="off" class="form-input">
        <button id="search-btn" class="control-btn">Search</button>
        <button id="locate-btn" class="control-btn secondary">
          <div class="location-spinner" id="location-spinner"></div>
          <span><i class="fas fa-map-marker-alt"></i> Locate Me</span>
        </button>
      </div>
      
      <div class="error-message" id="error">Location not found. Please try again.</div>
      
      <div class="weather-info" id="weather-info">
        <div class="location-info">
          <div id="location-name"></div>
          <div id="local-time"></div>
        </div>
        <div class="current-weather">
          <div class="temp-container">
            <div class="current-temp" id="current-temp"></div>
            <div class="condition-text" id="condition-text"></div>
          </div>
          <div class="weather-icon">
            <img id="weather-icon" src="/api/placeholder/100/100" alt="Weather Icon">
          </div>
        </div>
        
        <div class="details">
          <div class="detail-item">
            <div class="detail-label">Feels Like</div>
            <div class="detail-value" id="feels-like"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Humidity</div>
            <div class="detail-value" id="humidity"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Wind</div>
            <div class="detail-value" id="wind"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">UV Index</div>
            <div class="detail-value" id="uv"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Pressure</div>
            <div class="detail-value" id="pressure"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Precipitation</div>
            <div class="detail-value" id="precip"></div>
          </div>
        </div>
        
        <div class="forecast">
          <h3 style="font-size: 18px; margin-top: 22px; margin-bottom: 15px; color: var(--primary-color); text-align: center;">3-Day Forecast</h3>
          <div class="forecast-container" id="forecast-container"></div>
        </div>
      </div>
    </div>
  </div>
</div>
        </div>
      </div>

      <div class="dashboard-container">
        <div class="dashboard-card">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-seedling"></i>
            </div>
            <h2>Plant Information</h2>
          </div>

          <div id="plantInfo">
            <p id="plantName" style="font-size: 20px; font-weight: 600; margin-bottom: 12px; text-align: center;">Select a plant profile</p>
            <div id="careInfo" style="display: none;">
              <h3 style="font-size: 18px; margin-top: 22px; margin-bottom: 15px; color: var(--primary-color); text-align: center;">Optimal Conditions:</h3>
            </div>
          </div>
        </div>
      </div>

      <div class="last-updated">
        Last updated: <span id="lastUpdated">--</span>
      </div>
    </div>

    <!-- History Tab -->
    <div id="history" class="tab-content">
      <div class="dashboard-container">
        <div class="dashboard-card history-card">
          <div class="card-header">
            <h2>Watering Pattern Analysis</h2>
          </div>
          <div class="chart-container">
            <canvas id="wateringChart"></canvas>
          </div>
        </div>
      </div>
      </div>